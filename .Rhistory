"feed_autonomy",
"kg_DM_panim_maize_produced",
#"kg_DM_panim_soy_meal",
"share_soybean",
#"share_concent_purchased",
"share_concent",
"MFA_pcow",
"MFA_pha_pseudofarm",
"ha_temp_pasture_pha_pseudofarm",
"grassland_share_pseudofarm"#,
#"grassland_share_farm"
),
labels = c("Rendement (L lait / ha pseudoferme)",
"Rendement (L lait / vache laitière)",
"Taux de chargement (vache laitière / ha pseudoferme)",
"Taux de chargement (vache laitière / ha SFP)",
"Autonomie alimentaire (kg d'aliment produits / kg d'aliments)",
"Maïs fourrage (kg de maïs fourrage produit sur l'exploitation / vache laitière)",
#"Tourteau de soja (kg de tourteau de soja acheté / vache laitière)",
"Part du tourteau de soja importé (kg tourteau de soja / kg d'aliments)",
#"Part des concentrés dans les aliments achetés (kg de concentrés / kg d'aliments achetés)",
"Part des concentrés dans l'alimentation (kg de concentrés / kg d'aliments)",
"Surface Fourragère Principale (SFP / vache laitière)",
"Part de la Surface Fourragère Principale (ha SFP / ha pseudoferme)",
"Part des prairies temporaires (ha prairie / ha pseudoferme)",
"Part des prairies permanentes (ha prairie / ha pseudoferme)"#,
#"Part des prairies permanentes (ha prairie / ha ferme)"
))
# feed
tmp_practice_names_feed <- tibble(
practice = rev(c("feed_A.3.1_max",
"feed_A.4.5_max",
"feed_A.4.5_min_max",
"feed_A.4.5_org_max",
"feed_A.5.1_max",
"feed_yield")),
labels = rev(c("Travail du sol (L gazole / ha)",
"Fertilisation (kg N / ha)",
"Fertilisation (minérale)",
"Fertilisation (organique)",
"Produits phytosanitaires (€* / ha)",
"Rendement (kg / ha)")))
# all
tmp_practice_names <- Reduce(rbind,list(
tmp_practice_names_crops,
tmp_practice_names_herd,
tmp_practice_names_feed
))
# plot data ----
tmp_plot_data <- tmp_paired_ttest %>%
mutate(padjust = p.adjust(pval_pttest,method = "fdr")) %>%
rename(FQS = label) %>%
# choose displayed value
#mutate(plot_y = mean_diff_match) %>%
mutate(plot_y = mean) %>%
# add asterisk when signif
mutate(stat_grp = case_when(
padjust <= 0.05 ~ "*",.default = ""
)) %>%
# select only some products
filter(product_name %in% c("Ble tendre","Mais grain","Conventionnel","AB","Comte - Morbier","Beurre de Charentes-Poitou")
& match %in% c("no_match","Ble tendre__AB","Ble tendre__LR","Mais grain__AB",
"NA__AB","NA__Beurre de Charentes-Poitou","NA__Comte - Morbier")) %>%
# facet practices
mutate(practice_subset = case_when(
practice %in% tmp_practice_names_crops$practice ~ "practice_crops",
practice %in% tmp_practice_names_herd$practice ~ "practice_herd",
practice %in% tmp_practice_names_feed$practice ~ "practice_feed",
.default = "BVI"
))
# add y limit max
tmp_plot_data <- tmp_plot_data %>%
left_join(.,
tmp_plot_data %>% group_by(practice) %>% summarise(y_lim_max = max(plot_y+sd)) %>% ungroup(),
by = join_by(practice))
# plot colors ----
tmp_colors <- tibble(
FQS = c("AB","AB (en conversion)","AOP - AOC","Conventionnel","Contrefactuel","Contrefactuel_LR","IGP","IGP;LR","LR",
"Comte - Morbier","Bleu d'Auvergne - Cantal","Fromages de Savoie","Munster","Beurre de Charentes-Poitou"),
values = c("palegreen3","darkcyan","plum4","darkgrey","#333333","indianred4","goldenrod3","goldenrod3","indianred",
"plum4","plum4","goldenrod3","plum4","plum4"),
labels=c("AB","AB (en conversion)","AOP & AOC","Conventionnel","Contrefactuel","Contrefactuel_LR","IGP","IGP","Label Rouge",
"Comte - Morbier","Bleu d'Auvergne - Cantal","Fromages de Savoie","Munster","Beurre de Charentes-Poitou"))
names(tmp_colors$values) <- tmp_colors$FQS
names(tmp_colors$labels) <- tmp_colors$FQS
# practice labels ----
tmp_plot_data$practice <- factor(tmp_plot_data$practice,
levels = tmp_practice_names$practice,
labels = tmp_practice_names$labels)
tmp_plot_data %>%
filter(practice_subset == "practice_crops" &
product_name != "milk") %>%
ggplot(.) +
# value
geom_col(aes(x = practice, y = plot_y, fill = FQS),position = "dodge") +
# error bar
geom_errorbar(aes(x=practice, ymin = 0, ymax = plot_y+sd, colour = FQS),position = "dodge") +
# stat groups
geom_text(aes(x = practice,y=y_lim_max,colour = FQS,label = stat_grp),
size=10,position = position_dodge(width = 0.9),vjust=0.75,hjust=0.5) +
# theme
coord_flip() +
facet_wrap(vars(practice,product_name), scales = "free", ncol = 2L) +
#geom_blank(data = tmp_facet_scale,aes( y = scale))+
labs(y = "Moyenne et intervalle de confiance (95%)",x= "Pratiques") +
scale_fill_manual(values = tmp_colors$values,labels = tmp_colors$labels,) +
scale_colour_manual(values = tmp_colors$values,labels = tmp_colors$labels) +
theme_minimal() +
theme(legend.position ="bottom",
legend.direction = "horizontal",legend.title = element_blank(),
strip.background = element_blank(),
strip.text = element_blank())
View(tmp_paired_ttest)
tmp_plot_data %>%
filter(practice_subset == "practice_crops" &
product_name != "milk") %>%
ggplot(.) +
# value
geom_col(aes(x = practice, y = plot_y, fill = FQS),position = "dodge") +
# error bar
geom_errorbar(aes(x=practice, ymin = 0, ymax = plot_y+sd, colour = FQS),position = "dodge") +
# stat groups
geom_text(aes(x = practice,y=y_lim_max,colour = FQS,label = stat_grp),
size=10,position = position_dodge(width = 0.9),vjust=0.75,hjust=0.5) +
# theme
coord_flip() +
facet_wrap(vars(practice,match), scales = "free", ncol = 2L) +
#geom_blank(data = tmp_facet_scale,aes( y = scale))+
labs(y = "Moyenne et intervalle de confiance (95%)",x= "Pratiques") +
scale_fill_manual(values = tmp_colors$values,labels = tmp_colors$labels,) +
scale_colour_manual(values = tmp_colors$values,labels = tmp_colors$labels) +
theme_minimal() +
theme(legend.position ="bottom",
legend.direction = "horizontal",legend.title = element_blank(),
strip.background = element_blank(),
strip.text = element_blank())
tmp_plot_data %>%
filter(practice_subset == "practice_crops" &
match %in% c("Ble tendre__AB","Ble tendre__LR","Mais grain__AB")) %>%
ggplot(.) +
# value
geom_col(aes(x = practice, y = plot_y, fill = FQS),position = "dodge") +
# error bar
geom_errorbar(aes(x=practice, ymin = 0, ymax = plot_y+sd, colour = FQS),position = "dodge") +
# stat groups
geom_text(aes(x = practice,y=y_lim_max,colour = FQS,label = stat_grp),
size=10,position = position_dodge(width = 0.9),vjust=0.75,hjust=0.5) +
# theme
coord_flip() +
facet_wrap(vars(practice,match), scales = "free", ncol = 2L) +
#geom_blank(data = tmp_facet_scale,aes( y = scale))+
labs(y = "Moyenne et intervalle de confiance (95%)",x= "Pratiques") +
scale_fill_manual(values = tmp_colors$values,labels = tmp_colors$labels,) +
scale_colour_manual(values = tmp_colors$values,labels = tmp_colors$labels) +
theme_minimal() +
theme(legend.position ="bottom",
legend.direction = "horizontal",legend.title = element_blank(),
strip.background = element_blank(),
strip.text = element_blank())
tmp_plot_data %>%
filter(practice_subset == "practice_crops" &
match %in% c("Ble tendre__AB","Ble tendre__LR","Mais grain__AB")) %>%
ggplot(.) +
# value
geom_col(aes(x = practice, y = plot_y, fill = FQS),position = "dodge") +
# error bar
geom_errorbar(aes(x=practice, ymin = 0, ymax = plot_y+sd, colour = FQS),position = "dodge") +
# stat groups
geom_text(aes(x = practice,y=y_lim_max,colour = FQS,label = stat_grp),
size=10,position = position_dodge(width = 0.9),vjust=0.75,hjust=0.5) +
# theme
coord_flip() +
facet_wrap(vars(practice,match), scales = "free", ncol = 3L) +
#geom_blank(data = tmp_facet_scale,aes( y = scale))+
labs(y = "Moyenne et intervalle de confiance (95%)",x= "Pratiques") +
scale_fill_manual(values = tmp_colors$values,labels = tmp_colors$labels,) +
scale_colour_manual(values = tmp_colors$values,labels = tmp_colors$labels) +
theme_minimal() +
theme(legend.position ="bottom",
legend.direction = "horizontal",legend.title = element_blank(),
strip.background = element_blank(),
strip.text = element_blank())
View(tmp_plot_data)
grep("AB",tmp_plot_data$match)
tmp_paired_ttest %>% filter(label == "Conventionnel" & grep("AB",match))
tmp_paired_ttest %>% filter(label == "Conventionnel" & match %in% grep("AB",match))
tmp_paired_ttest %>% filter(label == "Conventionnel" & match %in% match[grep("AB",match)])
view(tmp_paired_ttest %>% filter(label == "Conventionnel" & match %in% match[grep("AB",match)]))
tmp_plot_data <- tmp_paired_ttest %>%
mutate(padjust = p.adjust(pval_pttest,method = "fdr")) %>%
# set FQS and conterfactuals
rename(FQS = case_when(
label == "Conventionnel" & match %in% match[grep("AB",match)] ~"Contrefactuel_AB",
label == "Conventionnel" & match %in% match[grep("LR",match)] ~"Contrefactuel_LR",
label == "Conventionnel" & match %in% match[grep("Comte - Morbier",match)] ~"Contrefactuel_Comte - Morbier",
label == "Conventionnel" & match %in% match[grep("Beurre de Charentes-Poitou",match)] ~"Beurre de Charentes-Poitou",
.default = label
)) %>%
# choose displayed value
#mutate(plot_y = mean_diff_match) %>%
mutate(plot_y = mean) %>%
# add asterisk when signif
mutate(stat_grp = case_when(
padjust <= 0.05 ~ "*",.default = ""
)) %>%
# select only some products
filter(product_name %in% c("Ble tendre","Mais grain","Conventionnel","AB","Comte - Morbier","Beurre de Charentes-Poitou")
& match %in% c("no_match","Ble tendre__AB","Ble tendre__LR","Mais grain__AB",
"NA__AB","NA__Beurre de Charentes-Poitou","NA__Comte - Morbier")) %>%
# facet practices
mutate(practice_subset = case_when(
practice %in% tmp_practice_names_crops$practice ~ "practice_crops",
practice %in% tmp_practice_names_herd$practice ~ "practice_herd",
practice %in% tmp_practice_names_feed$practice ~ "practice_feed",
.default = "BVI"
))
tmp_plot_data <- tmp_paired_ttest %>%
mutate(padjust = p.adjust(pval_pttest,method = "fdr")) %>%
# set FQS and conterfactuals
rename(FQS = case_when(
label == "Conventionnel" & match %in% match[grep("AB",match)] ~"Contrefactuel_AB",
label == "Conventionnel" & match %in% match[grep("LR",match)] ~"Contrefactuel_LR",
label == "Conventionnel" & match %in% match[grep("Comte - Morbier",match)] ~"Contrefactuel_Comte - Morbier",
label == "Conventionnel" & match %in% match[grep("Beurre de Charentes-Poitou",match)] ~"Beurre de Charentes-Poitou",
.default = label
))
tmp_plot_data <- tmp_paired_ttest %>%
mutate(padjust = p.adjust(pval_pttest,method = "fdr")) %>%
# set FQS and conterfactuals
rename(FQS = case_when( match %in% match[grep("AB",match)] ~ "Contrefactuel_AB")
)
tmp_plot_data <- tmp_paired_ttest %>%
mutate(padjust = p.adjust(pval_pttest,method = "fdr")) %>%
# set FQS and conterfactuals
rename(FQS = case_when(
label == "Conventionnel"~ "Contrefactuel_AB"))
tmp_plot_data <- tmp_paired_ttest %>%
mutate(padjust = p.adjust(pval_pttest,method = "fdr"))
tmp_plot_data <- tmp_paired_ttest %>%
rename(FQS = case_when(
label == "Conventionnel"~ "Contrefactuel_AB"))
tmp_plot_data <- tmp_paired_ttest %>%
mutate(padjust = p.adjust(pval_pttest,method = "fdr")) %>%
# set FQS and conterfactuals
mutate(FQS = case_when(
label == "Conventionnel" & match %in% match[grep("AB",match)] ~ "Contrefactuel_AB",
label == "Conventionnel" & match %in% match[grep("LR",match)] ~ "Contrefactuel_LR",
label == "Conventionnel" & match %in% match[grep("Comte - Morbier",match)] ~"Contrefactuel_Comte - Morbier",
label == "Conventionnel" & match %in% match[grep("Beurre de Charentes-Poitou",match)] ~"Beurre de Charentes-Poitou",
.default = label
)) %>%
# choose displayed value
#mutate(plot_y = mean_diff_match) %>%
mutate(plot_y = mean) %>%
# add asterisk when signif
mutate(stat_grp = case_when(
padjust <= 0.05 ~ "*",.default = ""
)) %>%
# select only some products
filter(product_name %in% c("Ble tendre","Mais grain","Conventionnel","AB","Comte - Morbier","Beurre de Charentes-Poitou")
& match %in% c("no_match","Ble tendre__AB","Ble tendre__LR","Mais grain__AB",
"NA__AB","NA__Beurre de Charentes-Poitou","NA__Comte - Morbier")) %>%
# facet practices
mutate(practice_subset = case_when(
practice %in% tmp_practice_names_crops$practice ~ "practice_crops",
practice %in% tmp_practice_names_herd$practice ~ "practice_herd",
practice %in% tmp_practice_names_feed$practice ~ "practice_feed",
.default = "BVI"
))
tmp_plot_data
View(tmp_plot_data)
tmp_plot_data <- tmp_paired_ttest %>%
mutate(padjust = p.adjust(pval_pttest,method = "fdr")) %>%
# set FQS and conterfactuals
mutate(FQS = case_when(
label == "Conventionnel" & match %in% match[grep("AB",match)] ~ "Contrefactuel_AB",
label == "Conventionnel" & match %in% match[grep("LR",match)] ~ "Contrefactuel_LR",
label == "Conventionnel" & match %in% match[grep("Comte - Morbier",match)] ~"Contrefactuel_Comte - Morbier",
label == "Conventionnel" & match %in% match[grep("Beurre de Charentes-Poitou",match)] ~"Contrefactuel_Beurre de Charentes-Poitou",
.default = label
)) %>%
# choose displayed value
#mutate(plot_y = mean_diff_match) %>%
mutate(plot_y = mean) %>%
# add asterisk when signif
mutate(stat_grp = case_when(
padjust <= 0.05 ~ "*",.default = ""
)) %>%
# select only some products
filter(product_name %in% c("Ble tendre","Mais grain","Conventionnel","AB","Comte - Morbier","Beurre de Charentes-Poitou")
& match %in% c("no_match","Ble tendre__AB","Ble tendre__LR","Mais grain__AB",
"NA__AB","NA__Beurre de Charentes-Poitou","NA__Comte - Morbier")) %>%
# facet practices
mutate(practice_subset = case_when(
practice %in% tmp_practice_names_crops$practice ~ "practice_crops",
practice %in% tmp_practice_names_herd$practice ~ "practice_herd",
practice %in% tmp_practice_names_feed$practice ~ "practice_feed",
.default = "BVI"
))
# add y limit max
tmp_plot_data <- tmp_plot_data %>%
left_join(.,
tmp_plot_data %>% group_by(practice) %>% summarise(y_lim_max = max(plot_y+sd)) %>% ungroup(),
by = join_by(practice))
# plot colors ----
tmp_colors <- tibble(
FQS = c("AB","Contrefactuel_AB","LR","Contrefactuel_LR",
"Comte - Morbier","Contrefactuel_Comte - Morbier","Beurre de Charentes-Poitou","Contrefactuel_Beurre de Charentes-Poitou"),
values = c("palegreen3","darkgrey","indianred","#333333",
"plum4","#cccccc","darkcyan","#333333"),
labels=c("AB","AB (en conversion)","AOP & AOC","Conventionnel","Contrefactuel","Contrefactuel_LR","IGP","IGP","Label Rouge",
"Comte - Morbier","Bleu d'Auvergne - Cantal","Fromages de Savoie","Munster","Beurre de Charentes-Poitou"))
# plot colors ----
tmp_colors <- tibble(
FQS = c("AB","Contrefactuel_AB","LR","Contrefactuel_LR",
"Comte - Morbier","Contrefactuel_Comte - Morbier","Beurre de Charentes-Poitou","Contrefactuel_Beurre de Charentes-Poitou"),
values = c("palegreen3","darkgrey","indianred","#333333",
"plum4","#cccccc","darkcyan","#333333"),
labels=c("AB","Contrefactuel AB","LR","Contrefactuel LR",
"Comte - Morbier","Contrefactuel Comte - Morbier","Beurre de Charentes-Poitou","Contrefactuel Beurre de Charentes-Poitou"))
names(tmp_colors$values) <- tmp_colors$FQS
names(tmp_colors$labels) <- tmp_colors$FQS
tmp_plot_data$practice <- factor(tmp_plot_data$practice,
levels = tmp_practice_names$practice,
labels = tmp_practice_names$labels)
tmp_plot_data %>%
filter(practice_subset == "practice_crops" &
match %in% c("Ble tendre__AB","Ble tendre__LR","Mais grain__AB")) %>%
ggplot(.) +
# value
geom_col(aes(x = practice, y = plot_y, fill = FQS),position = "dodge") +
# error bar
geom_errorbar(aes(x=practice, ymin = 0, ymax = plot_y+sd, colour = FQS),position = "dodge") +
# stat groups
geom_text(aes(x = practice,y=y_lim_max,colour = FQS,label = stat_grp),
size=10,position = position_dodge(width = 0.9),vjust=0.75,hjust=0.5) +
# theme
coord_flip() +
facet_wrap(vars(practice,match), scales = "free", ncol = 3L) +
#geom_blank(data = tmp_facet_scale,aes( y = scale))+
labs(y = "Moyenne et intervalle de confiance (95%)",x= "Pratiques") +
scale_fill_manual(values = tmp_colors$values,labels = tmp_colors$labels,) +
scale_colour_manual(values = tmp_colors$values,labels = tmp_colors$labels) +
theme_minimal() +
theme(legend.position ="bottom",
legend.direction = "horizontal",legend.title = element_blank(),
strip.background = element_blank(),
strip.text = element_blank())
tmp_plot_data <- tmp_paired_ttest %>%
mutate(padjust = p.adjust(pval_pttest,method = "bonferonni")) %>%
# set FQS and conterfactuals
mutate(FQS = case_when(
label == "Conventionnel" & match %in% match[grep("AB",match)] ~ "Contrefactuel_AB",
label == "Conventionnel" & match %in% match[grep("LR",match)] ~ "Contrefactuel_LR",
label == "Conventionnel" & match %in% match[grep("Comte - Morbier",match)] ~"Contrefactuel_Comte - Morbier",
label == "Conventionnel" & match %in% match[grep("Beurre de Charentes-Poitou",match)] ~"Contrefactuel_Beurre de Charentes-Poitou",
.default = label
)) %>%
# choose displayed value
#mutate(plot_y = mean_diff_match) %>%
mutate(plot_y = mean) %>%
# add asterisk when signif
mutate(stat_grp = case_when(
padjust <= 0.05 ~ "*",.default = ""
)) %>%
# select only some products
filter(product_name %in% c("Ble tendre","Mais grain","Conventionnel","AB","Comte - Morbier","Beurre de Charentes-Poitou")
& match %in% c("no_match","Ble tendre__AB","Ble tendre__LR","Mais grain__AB",
"NA__AB","NA__Beurre de Charentes-Poitou","NA__Comte - Morbier")) %>%
# facet practices
mutate(practice_subset = case_when(
practice %in% tmp_practice_names_crops$practice ~ "practice_crops",
practice %in% tmp_practice_names_herd$practice ~ "practice_herd",
practice %in% tmp_practice_names_feed$practice ~ "practice_feed",
.default = "BVI"
))
tmp_plot_data <- tmp_paired_ttest %>%
mutate(padjust = p.adjust(pval_pttest,method = "bonferroni")) %>%
# set FQS and conterfactuals
mutate(FQS = case_when(
label == "Conventionnel" & match %in% match[grep("AB",match)] ~ "Contrefactuel_AB",
label == "Conventionnel" & match %in% match[grep("LR",match)] ~ "Contrefactuel_LR",
label == "Conventionnel" & match %in% match[grep("Comte - Morbier",match)] ~"Contrefactuel_Comte - Morbier",
label == "Conventionnel" & match %in% match[grep("Beurre de Charentes-Poitou",match)] ~"Contrefactuel_Beurre de Charentes-Poitou",
.default = label
)) %>%
# choose displayed value
#mutate(plot_y = mean_diff_match) %>%
mutate(plot_y = mean) %>%
# add asterisk when signif
mutate(stat_grp = case_when(
padjust <= 0.05 ~ "*",.default = ""
)) %>%
# select only some products
filter(product_name %in% c("Ble tendre","Mais grain","Conventionnel","AB","Comte - Morbier","Beurre de Charentes-Poitou")
& match %in% c("no_match","Ble tendre__AB","Ble tendre__LR","Mais grain__AB",
"NA__AB","NA__Beurre de Charentes-Poitou","NA__Comte - Morbier")) %>%
# facet practices
mutate(practice_subset = case_when(
practice %in% tmp_practice_names_crops$practice ~ "practice_crops",
practice %in% tmp_practice_names_herd$practice ~ "practice_herd",
practice %in% tmp_practice_names_feed$practice ~ "practice_feed",
.default = "BVI"
))
# add y limit max
tmp_plot_data <- tmp_plot_data %>%
left_join(.,
tmp_plot_data %>% group_by(practice) %>% summarise(y_lim_max = max(plot_y+sd)) %>% ungroup(),
by = join_by(practice))
# plot colors ----
tmp_colors <- tibble(
FQS = c("AB","Contrefactuel_AB","LR","Contrefactuel_LR",
"Comte - Morbier","Contrefactuel_Comte - Morbier","Beurre de Charentes-Poitou","Contrefactuel_Beurre de Charentes-Poitou"),
values = c("palegreen3","darkgrey","indianred","#333333",
"plum4","#cccccc","darkcyan","#333333"),
labels=c("AB","Contrefactuel AB","LR","Contrefactuel LR",
"Comte - Morbier","Contrefactuel Comte - Morbier","Beurre de Charentes-Poitou","Contrefactuel Beurre de Charentes-Poitou"))
names(tmp_colors$values) <- tmp_colors$FQS
names(tmp_colors$labels) <- tmp_colors$FQS
tmp_plot_data$practice <- factor(tmp_plot_data$practice,
levels = tmp_practice_names$practice,
labels = tmp_practice_names$labels)
tmp_plot_data %>%
filter(practice_subset == "practice_crops" &
match %in% c("Ble tendre__AB","Ble tendre__LR","Mais grain__AB")) %>%
ggplot(.) +
# value
geom_col(aes(x = practice, y = plot_y, fill = FQS),position = "dodge") +
# error bar
geom_errorbar(aes(x=practice, ymin = 0, ymax = plot_y+sd, colour = FQS),position = "dodge") +
# stat groups
geom_text(aes(x = practice,y=y_lim_max,colour = FQS,label = stat_grp),
size=10,position = position_dodge(width = 0.9),vjust=0.75,hjust=0.5) +
# theme
coord_flip() +
facet_wrap(vars(practice,match), scales = "free", ncol = 3L) +
#geom_blank(data = tmp_facet_scale,aes( y = scale))+
labs(y = "Moyenne et intervalle de confiance (95%)",x= "Pratiques") +
scale_fill_manual(values = tmp_colors$values,labels = tmp_colors$labels,) +
scale_colour_manual(values = tmp_colors$values,labels = tmp_colors$labels) +
theme_minimal() +
theme(legend.position ="bottom",
legend.direction = "horizontal",legend.title = element_blank(),
strip.background = element_blank(),
strip.text = element_blank())
# practice
geom_col(aes(x = practice, y = mean, fill = FQS)) +
# stat groups
geom_text(aes(x = plot_x,y=0,colour = "black",label = stat_grp,fontface = "bold"),
size=12,position = position_dodge(width = 0.9)) +
# theme
facet_grid(rows = vars(practice), scales = "free_y",
labeller = label_wrap_gen(multi_line = TRUE)) +
geom_blank(data = tmp_facet_scale,aes( y = scale))+
labs(y = "Moyenne des différences avec les contrefactuels",x= "Produits") +
scale_fill_manual(values = tmp_colors$values,labels = tmp_colors$labels,) +
scale_colour_manual(values = tmp_colors$values,labels = tmp_colors$labels) +
theme_minimal() +
theme(legend.position ="bottom",
legend.direction = "horizontal",legend.title = element_blank())
tmp_plot_data %>%
filter(practice_facet == "practice_herd" &
product_RICA_CODE == "milk") %>%
ggplot(.) +
# value
geom_col(aes(x = practice, y = plot_y, fill = FQS),position = "dodge") +
# error bar
geom_errorbar(aes(x=practice, ymin = 0, ymax = plot_y+sd, colour = FQS),position = "dodge") +
# stat groups
geom_text(aes(x = practice,y=y_lim_max,colour = FQS,label = stat_grp),
size=10,position = position_dodge(width = 0.9),vjust=0.75,hjust=0.5) +
# theme
coord_flip() +
facet_wrap(vars(practice), scales = "free", ncol = 1L) +
#geom_blank(data = tmp_facet_scale,aes( y = scale))+
labs(y = "Moyenne et intervalle de confiance (95%)",x= "Pratiques") +
scale_fill_manual(values = tmp_colors$values,labels = tmp_colors$labels,) +
scale_colour_manual(values = tmp_colors$values,labels = tmp_colors$labels) +
theme_minimal() +
theme(legend.position ="bottom",
legend.direction = "horizontal",legend.title = element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
tmp_plot_data %>%
filter(practice_subset == "practice_herd" &
product_RICA_CODE == "milk") %>%
ggplot(.) +
# value
geom_col(aes(x = practice, y = plot_y, fill = FQS),position = "dodge") +
# error bar
geom_errorbar(aes(x=practice, ymin = 0, ymax = plot_y+sd, colour = FQS),position = "dodge") +
# stat groups
geom_text(aes(x = practice,y=y_lim_max,colour = FQS,label = stat_grp),
size=10,position = position_dodge(width = 0.9),vjust=0.75,hjust=0.5) +
# theme
coord_flip() +
facet_wrap(vars(practice), scales = "free", ncol = 1L) +
#geom_blank(data = tmp_facet_scale,aes( y = scale))+
labs(y = "Moyenne et intervalle de confiance (95%)",x= "Pratiques") +
scale_fill_manual(values = tmp_colors$values,labels = tmp_colors$labels,) +
scale_colour_manual(values = tmp_colors$values,labels = tmp_colors$labels) +
theme_minimal() +
theme(legend.position ="bottom",
legend.direction = "horizontal",legend.title = element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
7482.114 -
4636.540
(7482.114 -
4636.540)/7482.114
(6493.519-3361.254)/6493.519
(3643.153-2533.595)/3643.153
