"0",""
"0","library(gt)"
"0","library(dplyr)"
"0","library(tidyr)"
"0",""
"0","tmp_data <- read.csv(""~/BiodivLabel/CASD_export/CASD_export_250122/stat_desc_by_OTEX_2025-01-22.csv"")"
"0",""
"0","tmp_table <- tmp_data %>%"
"0","    filter(OTEFDA %in% c(1516,4500,4700,6184)) %>%"
"0","filter(FQS %in% c(""AB"",""Conventionnel"",""LR"",""Beurre de Charentes-Poitou"","
"0","""Bleu d'Auvergne - Cantal"",""Comte - Morbier"",""Fromages de Savoie"",""Munster"")) %>%"
"0","    mutate(FQS = case_when("
"0","        FQS == ""Conventionnel"" ~""Conventionnel"","
"0","        FQS == ""AB"" ~""AB"","
"0","        .default = ""FQS"""
"0","    )) %>% "
"0","    group_by(OTEFDA,FQS) %>%"
"0","    summarise("
"0","        nobs = sum(nobs,na.rm = T),"
"0","        crop_area_ha = mean(crop_area_ha,na.rm = T),"
"0","        grassland_area_ha = mean(grassland_area_ha,na.rm = T),"
"0","        nb_dairy_cow = mean(nb_dairy_cow,na.rm = T),"
"0","        wheat_yield_t_ha = mean(wheat_yield_t_ha,na.rm = T),"
"0","        milk_yield_kg_cow = mean(milk_yield_kg_cow,na.rm = T),"
"0","        .groups = ""keep"""
"0","    ) %>% ungroup() %>%"
"0","mutate(OTEFDA = case_when("
"0","    OTEFDA == 1516 ~ ""Field crops"","
"0","    OTEFDA == 4500 ~ ""Dairy cattle"","
"0","    OTEFDA == 4700 ~ ""Mixed cattle"","
"0","    OTEFDA == 6184 ~ ""Mixed crop and/or mixed livestock"""
"0",")) %>%"
"0","    pivot_longer(cols = !c(OTEFDA,FQS),"
"0","                 names_to = ""Variable"","
"0","                 values_to = ""value"") %>%"
"0","    mutate("
"0","        Variable = case_when("
"0","            Variable == ""nobs"" ~ ""Farm number"","
"0","            Variable == ""crop_area_ha"" ~ ""Crop area (ha)"","
"0","            Variable == ""grassland_area_ha"" ~ ""Permanent grassland area (ha)"","
"0","            Variable == ""nb_dairy_cow"" ~ ""Dairy herd size (number of cow)"","
"0","            Variable == ""wheat_yield_t_ha"" ~ ""Wheat yield (t/ha)"","
"0","            Variable == ""milk_yield_kg_cow"" ~ ""Milk yield (L/cow)"""
"0","        )"
"0","    ) %>%"
"0","pivot_wider("
"0","    id_cols = c(OTEFDA,Variable),"
"0","    names_from = FQS,"
"0","    values_from = value"
"0",")"
"0",""
"0",""
"0","tmp_table %>%"
"0","    # groups"
"0","    mutate(OTEFDA = ifelse(row_number() == 1,"
"0","                           as.character(OTEFDA), """"),"
"0","           .by = OTEFDA) %>%"
"0","    select(OTEFDA,Variable,Conventionnel,AB,FQS) %>%"
"0","    gt() %>%"
"0","    cols_label("
"0","        OTEFDA = ""Technical Orientation"","
"0","        AB = ""Organic Farming"","
"0","        FQS = ""Other FQSs"""
"0","    ) %>%"
"0","    # replace NAs"
"0","    sub_missing(missing_text = ""-"") %>%"
"0","    # format numbers"
"0","    fmt_auto()"
